<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Egg Sorting Performance Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .kpi-card {
            background-color: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .kpi-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .chart-container {
            background-color: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            display: flex;
            flex-direction: column;
        }
        .table-cell {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0; /* slate-200 */
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-slate-800">Egg Sorting Performance Dashboard</h1>
            <p class="text-slate-500">ภาพรวมผลผลิตและประสิทธิภาพ (ข้อมูล ก.พ. - ก.ค. 2025)</p>
        </header>

        <!-- KPI Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="kpi-card">
                <h3 class="text-slate-500 font-semibold">Base Case ที่แนะนำ</h3>
                <p class="text-3xl font-bold text-sky-600">36,000</p>
                <p class="text-slate-500">ฟอง/ชั่วโมง (60% Perf.)</p>
            </div>
            <div class="kpi-card">
                <h3 class="text-slate-500 font-semibold">ผลผลิตเฉลี่ย (6 เดือน)</h3>
                <p class="text-3xl font-bold text-slate-800">35,364</p>
                <p class="text-slate-500">ฟอง/ชั่วโมง (58.9% Perf.)</p>
            </div>
            <div class="kpi-card">
                <h3 class="text-slate-500 font-semibold">ผลผลิตสูงสุดที่ทำได้</h3>
                <p class="text-3xl font-bold text-emerald-600">40,920</p>
                <p class="text-slate-500">ฟอง/ชั่วโมง (68.2% Perf.)</p>
            </div>
            <div class="kpi-card">
                <h3 class="text-slate-500 font-semibold">ศักยภาพที่ไปถึงได้</h3>
                <p class="text-3xl font-bold text-amber-600">+8-10%</p>
                <p class="text-slate-500">จาก Performance ปัจจุบัน</p>
            </div>
        </div>

        <!-- Main Charts Row -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
            <!-- Monthly Performance Chart -->
            <div class="chart-container lg:col-span-2">
                <h3 class="text-xl font-bold text-slate-800 mb-4">แนวโน้ม Performance รายเดือน</h3>
                <div class="relative h-80">
                    <canvas id="monthlyPerformanceChart"></canvas>
                </div>
            </div>
            <!-- Production Distribution Chart -->
            <div class="chart-container">
                <h3 class="text-xl font-bold text-slate-800 mb-1">การกระจายตัวของผลผลิต (Histogram)</h3>
                <p class="text-sm text-slate-500 mb-4">นับจำนวนวันในแต่ละช่วงผลผลิต</p>
                <div class="relative h-80">
                    <canvas id="distributionChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Deeper Dive Section -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
             <!-- Base Case Analysis -->
            <div class="chart-container">
                <h3 class="text-xl font-bold text-slate-800 mb-4">วิเคราะห์ Base Case</h3>
                <p class="text-slate-600 mb-4">เลือกดูระดับเป้าหมายที่แตกต่างกัน</p>
                <div class="space-y-3" id="baseCaseDisplay">
                     <!-- Display card updated by JS -->
                </div>
                <div class="flex space-x-2 mt-4">
                    <button onclick="updateBaseCase('conservative')" class="w-full bg-sky-100 text-sky-800 font-semibold py-2 px-4 rounded-lg hover:bg-sky-200 transition">ระมัดระวัง</button>
                    <button onclick="updateBaseCase('moderate')" class="w-full bg-indigo-100 text-indigo-800 font-semibold py-2 px-4 rounded-lg hover:bg-indigo-200 transition">ปานกลาง</button>
                    <button onclick="updateBaseCase('stretch')" class="w-full bg-amber-100 text-amber-800 font-semibold py-2 px-4 rounded-lg hover:bg-amber-200 transition">ท้าทาย</button>
                </div>
            </div>
            <!-- Loss Time Impact Chart -->
            <div class="chart-container">
                <h3 class="text-xl font-bold text-slate-800 mb-4">ผลกระทบจาก Loss Time</h3>
                <div class="relative h-80">
                    <canvas id="lossTimeChart"></canvas>
                </div>
            </div>
            <!-- Operation Time Impact Chart -->
            <div class="chart-container">
                <h3 class="text-xl font-bold text-slate-800 mb-4">ผลกระทบจากชั่วโมงทำงาน</h3>
                <div class="relative h-80">
                    <canvas id="operationTimeChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Scatter Plots Row -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <div class="chart-container">
                <h3 class="text-xl font-bold text-slate-800 mb-1">การกระจุกตัวของผลผลิตรายวัน (Jitter Plot)</h3>
                <p class="text-sm text-slate-500 mb-4">แต่ละจุดคือ 1 วัน ยิ่งกระจุกแน่นยิ่งทำได้บ่อย</p>
                <div class="relative h-96">
                    <canvas id="jitterPlotChart"></canvas>
                </div>
            </div>
            <div class="chart-container">
                <h3 class="text-xl font-bold text-slate-800 mb-1">ความสัมพันธ์ Loss Time vs. ผลผลิต</h3>
                <p class="text-sm text-slate-500 mb-4">แสดงแนวโน้ม: Loss Time น้อย ผลผลิตสูง</p>
                <div class="relative h-96">
                    <canvas id="scatterPlotChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Summary Table Section -->
        <div class="chart-container">
            <h3 class="text-xl font-bold text-slate-800 mb-4">ตารางสรุปข้อมูลและค่าสถิติ</h3>
            <div class="overflow-x-auto">
                <table class="min-w-full bg-white">
                    <thead class="bg-slate-50">
                        <tr>
                            <th class="table-cell text-left font-semibold text-slate-600">รายการ</th>
                            <th class="table-cell text-left font-semibold text-slate-600">ค่า</th>
                            <th class="table-cell text-left font-semibold text-slate-600">หมายเหตุ</th>
                        </tr>
                    </thead>
                    <tbody class="text-slate-700">
                        <tr><td colspan="3" class="table-cell bg-slate-100 font-bold">ค่าสถิติผลผลิต (ฟอง/ชม.)</td></tr>
                        <tr><td class="table-cell">ต่ำสุด (Minimum)</td><td class="table-cell font-mono">27,450</td><td class="table-cell">-</td></tr>
                        <tr><td class="table-cell">ควอร์ไทล์ที่ 1 (Q1)</td><td class="table-cell font-mono">33,378</td><td class="table-cell">25% ของวันทำได้ต่ำกว่านี้</td></tr>
                        <tr><td class="table-cell">ค่ากลาง (Median)</td><td class="table-cell font-mono">35,582</td><td class="table-cell">50% ของวันทำได้สูง/ต่ำกว่านี้</td></tr>
                        <tr><td class="table-cell">ค่าเฉลี่ย (Mean)</td><td class="table-cell font-mono">35,364</td><td class="table-cell">-</td></tr>
                        <tr><td class="table-cell">ควอร์ไทล์ที่ 3 (Q3)</td><td class="table-cell font-mono">37,278</td><td class="table-cell">75% ของวันทำได้ต่ำกว่านี้</td></tr>
                        <tr><td class="table-cell">สูงสุด (Maximum)</td><td class="table-cell font-mono">40,920</td><td class="table-cell">Performance 68.2%</td></tr>
                        <tr><td colspan="3" class="table-cell bg-slate-100 font-bold">Base Case ที่แนะนำ (ฟอง/ชม.)</td></tr>
                        <tr><td class="table-cell">หลัก (ทั่วไป)</td><td class="table-cell font-mono text-sky-600 font-bold">36,000</td><td class="table-cell">60% Performance, สมดุลและท้าทาย</td></tr>
                        <tr><td class="table-cell">ขั้นต่ำ (เริ่มต้น)</td><td class="table-cell font-mono">33,000</td><td class="table-cell">55% Performance, สำหรับพนักงานใหม่/ช่วงมีปัญหา</td></tr>
                        <tr><td class="table-cell">ท้าทาย (เป้าสูง)</td><td class="table-cell font-mono">37,500</td><td class="table-cell">62.5% Performance, สำหรับทีมเก่ง/High Season</td></tr>
                        <tr><td colspan="3" class="table-cell bg-slate-100 font-bold">ข้อมูลเครื่องจักรและภาพรวม</td></tr>
                        <tr><td class="table-cell">ความสามารถตามสเปค</td><td class="table-cell font-mono">60,000</td><td class="table-cell">Nabel Oracion 6000</td></tr>
                        <tr><td class="table-cell">Performance เฉลี่ย (6 เดือน)</td><td class="table-cell font-mono">58.94%</td><td class="table-cell">จากข้อมูล 154 วัน</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div>

<script>
    // --- Raw Data from User ---
    const rawData = `
Date	A	P	Q	OEE	Product/H	Total producct_Machine	Up Time	Start Time	Finish Time	Planned Stop	Oparation Time	Loss Time	H1_Product	H2_Product	H3_Product	H4_Product	H5_Product	H6_Product	Total Product
01/02/2025	88.34%	53.06%	99.73%	46.74%	31,835	209,520	06:34:53	07:15:00	15:42:00	01:00:00	7:27:00	0:52:07	36935	35518		54686	23981	58262	209382
02/02/2025	87.05%	52.12%	99.71%	45.24%	31,274	213,706	06:50:00	07:15:00	16:06:00	01:00:00	7:51:00	1:01:00	37379	35350		54235	28398	58269	213631
03/02/2025	88.84%	53.38%	99.78%	47.32%	32,027	213,407	06:39:48	07:15:00	15:45:00	01:00:00	7:30:00	0:50:12	35233	34175		53844	31835	58193	213280
04/02/2025	88.31%	56.36%	99.75%	49.65%	33,818	225,493	06:40:04	07:15:00	15:48:00	01:00:00	7:33:00	0:52:56	39682	35549		56110	35698	58373	225412
05/02/2025	87.16%	54.91%	99.80%	47.76%	32,944	220,132	06:40:55	07:15:00	15:55:00	01:00:00	7:40:00	0:59:05	35115	34402		53298	38916	58296	220027
06/02/2025	85.96%	54.24%	99.72%	46.50%	32,545	230,804	07:05:31	07:15:00	16:30:00	01:00:00	8:15:00	1:09:29	38696	35266		56069	41971	58702	230704
07/02/2025	88.41%	54.49%	99.75%	48.06%	32,696	223,530	06:50:12	07:15:00	15:59:00	01:00:00	7:44:00	0:53:48	35693	35330		52086	42686	57848	223643
08/02/2025	88.84%	56.74%	99.66%	50.23%	34,043	233,375	06:51:19	07:15:00	15:58:00	01:00:00	7:43:00	0:51:41	38536	35476		55748	45334	58206	233300
09/02/2025	89.70%	55.12%	99.77%	49.33%	33,070	227,924	06:53:32	07:15:00	15:56:00	01:00:00	7:41:00	0:47:28	35188	34462		53046	46782	58281	227759
10/02/2025	89.26%	56.02%	99.72%	49.86%	33,610	232,010	06:54:11	07:15:00	15:59:00	01:00:00	7:44:00	0:49:49	36742	34963		54215	47929	58064	231913
11/02/2025	87.18%	60.60%	99.73%	52.68%	36,360	232,974	06:24:27	07:15:00	15:36:00	01:00:00	7:21:00	0:56:33	36916	34530		54537	48910	57918	232811
12/02/2025	88.45%	60.04%	99.74%	52.96%	36,023	236,831	06:34:28	07:15:00	15:41:00	01:00:00	7:26:00	0:51:32	37159	36455		54299	50518	58291	236722
13/02/2025	91.75%	58.68%	99.78%	53.72%	35,208	235,824	06:41:53	07:15:00	15:33:00	01:00:00	7:18:00	0:36:07	36714	34536		54937	51312	58184	235683
14/02/2025	89.25%	59.37%	99.76%	52.86%	35,619	236,827	06:38:56	07:15:00	15:42:00	01:00:00	7:27:00	0:48:04	37438	35226		54411	51582	58083	236740
15/02/2025	88.72%	60.21%	99.79%	53.31%	36,129	238,810	06:36:36	07:15:00	15:42:00	01:00:00	7:27:00	0:50:24	37042	35797		55345	52408	58019	238611
16/02/2025	90.67%	56.37%	99.71%	50.96%	33,823	234,083	06:55:15	07:15:00	15:53:00	01:00:00	7:38:00	0:42:45	35316	34645		53266	52764	58004	233995
17/02/2025	87.58%	60.04%	99.69%	52.42%	36,024	240,300	06:40:14	07:15:00	15:52:00	01:00:00	7:37:00	0:56:46	37877	35257		55655	53259	58051	240099
18/02/2025	84.95%	59.80%	99.74%	50.67%	35,877	239,253	06:40:07	07:15:00	16:06:00	01:00:00	7:51:00	1:10:53	35896	35311		55424	53926	58583	239140
19/02/2025	88.60%	58.86%	99.74%	52.01%	35,314	234,153	06:37:50	07:15:00	15:44:00	01:00:00	7:29:00	0:51:10	35182	35086		52454	53653	57634	234009
20/02/2025	89.23%	60.13%	99.78%	53.53%	36,076	237,128	06:34:23	07:15:00	15:37:00	01:00:00	7:22:00	0:47:37	35173	35629		54090	54063	58070	237025
21/02/2025	83.15%	56.38%	99.69%	46.74%	33,827	234,403	06:55:46	07:15:00	16:35:00	01:00:00	8:20:00	1:24:14	34574	34111		52339	55112	58052	234188
22/02/2025	87.31%	60.90%	99.73%	53.02%	36,538	240,844	06:35:30	07:15:00	15:48:00	01:00:00	7:33:00	0:57:30	37210	35716		56130	53993	57663	240712
23/02/2025	89.40%	57.84%	99.78%	51.60%	34,704	235,805	06:47:41	07:15:00	15:51:00	01:00:00	7:36:00	0:48:19	35227	34281		53444	54884	57725	235561
24/02/2025	87.59%	60.09%	99.71%	52.49%	36,056	238,970	06:37:40	07:15:00	15:49:00	01:00:00	7:34:00	0:56:20	36303	35274		55036	54669	57512	238794
25/02/2025	89.42%	60.96%	99.74%	54.37%	36,577	237,680	06:29:53	07:15:00	15:31:00	01:00:00	7:16:00	0:46:07	35384	35395		54669	54923	57161	237532
26/02/2025	89.43%	60.42%	99.83%	53.94%	36,250	236,110	06:30:48	07:15:00	15:32:00	01:00:00	7:17:00	0:46:12	35270	35077		53495	55076	57101	236019
27/02/2025	90.28%	59.29%	99.74%	53.39%	35,575	239,273	06:43:33	07:15:00	15:42:00	01:00:00	7:27:00	0:43:27	36385	35311		54936	55499	56997	239128
28/02/2025	86.04%	62.42%	99.76%	53.58%	37,453	241,689	06:27:11	07:15:00	15:45:00	01:00:00	7:30:00	1:02:49	37656	36015		55178	55337	57376	241562
01/03/2025	86.64%	59.82%	99.75%	51.70%	35,895	235,850	06:34:14	07:15:00	15:50:00	01:00:00	7:35:00	1:00:46	34952	34235		53633	55316	57626	235762
02/03/2025	86.07%	61.59%	99.66%	52.83%	36,956	241,734	06:32:28	07:15:00	15:51:00	01:00:00	7:36:00	1:03:32	37550	36075		55232	54820	57938	241615
03/03/2025	85.57%	59.49%	99.75%	50.78%	35,692	238,234	06:40:29	07:15:00	16:03:00	01:00:00	7:48:00	1:07:31	35570	33844		55075	55482	58159	238130
04/03/2025	87.12%	60.16%	99.73%	52.27%	36,099	236,406	06:32:56	07:15:00	15:46:00	01:00:00	7:31:00	0:58:04	34645	34535		53985	55028	58108	236301
05/03/2025	87.52%	60.12%	99.71%	52.46%	36,070	237,303	06:34:44	07:15:00	15:46:00	01:00:00	7:31:00	0:56:16	34645	35282		54173	55030	58038	237168
06/03/2025	85.19%	60.80%	99.70%	51.64%	36,482	235,159	06:26:45	07:15:00	15:49:00	01:00:00	7:34:00	1:07:15	34345	33994		53510	55090	57996	234935
07/03/2025	87.21%	60.36%	99.75%	52.50%	36,215	236,340	06:31:34	07:15:00	15:44:00	01:00:00	7:29:00	0:57:26	34351	34622		54247	55048	57959	236227
08/03/2025	82.14%	62.06%	99.75%	50.85%	37,237	232,451	06:14:33	07:15:00	15:51:00	01:00:00	7:36:00	1:21:27	34601	34559		51851	55104	57563	233678
09/03/2025	92.42%	57.46%	99.77%	52.98%	34,474	239,481	06:56:48	07:15:00	15:46:00	01:00:00	7:31:00	0:34:12	36041	34742		56420	54796	57383	239382
10/03/2025	86.97%	58.59%	99.73%	50.81%	35,152	235,394	06:41:47	07:15:00	15:57:00	01:00:00	7:42:00	1:00:13	35315	34665		53117	54873	57329	235299
11/03/2025	83.07%	60.39%	99.75%	50.04%	36,235	239,300	06:36:15	07:15:00	16:12:00	01:00:00	7:57:00	1:20:45	35216	35484		55577	55138	57742	239157
12/03/2025	88.66%	57.33%	99.73%	50.69%	34,397	232,801	06:46:05	07:15:00	15:53:00	01:00:00	7:38:00	0:51:55	34602	34087		52387	54693	56906	232675
13/03/2025	62.66%	59.32%	99.75%	37.08%	35,594	242,372	06:48:34	04:45:00	16:37:00	01:00:00	10:52:00	4:03:26	36248	36575		55994	55609	57749	242175
14/03/2025	65.76%	56.76%	99.75%	37.23%	34,057	228,067	06:41:48	04:45:00	15:56:00	01:00:00	10:11:00	3:29:12	32367	32866		52025	54423	56237	227918
15/03/2025	67.60%	56.58%	99.76%	38.16%	33,950	234,086	06:53:42	04:45:00	15:57:00	01:00:00	10:12:00	3:18:18	33352	34548		53535	55314	57212	233961
16/03/2025	89.11%	58.62%	99.74%	52.10%	35,170	233,482	06:38:19	07:15:00	15:42:00	01:00:00	7:27:00	0:48:41	34295	34228		52561	55315	56927	233326
17/03/2025	93.36%	56.40%	99.79%	52.55%	33,841	232,223	06:51:44	07:15:00	15:36:00	01:00:00	7:21:00	0:29:16	33154	33561		53164	55578	56766	232223
18/03/2025	85.98%	60.66%	99.74%	52.01%	36,393	237,283	06:31:12	07:15:00	15:50:00	01:00:00	7:35:00	1:03:48	35256	34896		54739	55688	56622	237201
19/03/2025	86.85%	57.94%	99.77%	50.20%	34,762	233,487	06:43:00	07:15:00	15:59:00	01:00:00	7:44:00	1:01:00	34228	32774		54259	55633	56474	233368
20/03/2025	88.92%	54.85%	99.75%	48.65%	32,912	231,197	07:01:29	07:15:00	16:09:00	01:00:00	7:54:00	0:52:31	32658	33646		52163	55731	56872	231070
21/03/2025	85.63%	59.53%	99.78%	50.87%	35,720	231,954	06:29:37	07:15:00	15:50:00	01:00:00	7:35:00	1:05:23	32987	33618		53563	55555	56145	231868
22/03/2025	83.67%	61.46%	99.84%	51.34%	36,875	236,532	06:24:52	07:15:00	15:55:00	01:00:00	7:40:00	1:15:08	34722	35687		54862	55970	56592	237833
23/03/2025	86.45%	59.81%	99.77%	51.58%	35,885	229,552	06:23:49	07:15:00	15:39:00	01:00:00	7:24:00	1:00:11	32245	32435		53072	55698	56011	229461
24/03/2025	89.20%	59.31%	99.75%	52.77%	35,586	237,000	06:39:36	07:15:00	15:43:00	01:00:00	7:28:00	0:48:24	34329	35125		55070	56081	56289	236894
25/03/2025	82.70%	58.08%	99.68%	47.88%	34,847	235,355	06:45:14	07:15:00	16:25:00	01:00:00	8:10:00	1:24:46	34719	33016		54565	56388	56620	235308
26/03/2025	89.46%	57.40%	99.72%	51.20%	34,438	229,000	06:38:59	07:15:00	15:41:00	01:00:00	7:26:00	0:47:01	31883	33548		52191	55688	55635	228945
27/03/2025	86.94%	58.98%	99.71%	51.13%	35,388	236,384	06:40:47	07:15:00	15:56:00	01:00:00	7:41:00	1:00:13	34938	33808		55034	56206	56313	236299
28/03/2025	80.43%	59.73%	99.69%	47.89%	35,840	234,921	06:33:17	07:15:00	16:24:00	01:00:00	8:09:00	1:35:43	34405	33219		54490	56339	56366	234819
29/03/2025	85.94%	57.06%	99.76%	48.92%	34,238	234,414	06:50:48	07:15:00	16:13:00	01:00:00	7:58:00	1:07:12	33942	34169		53858	56126	56141	234236
30/03/2025	85.95%	57.99%	99.71%	49.70%	34,793	227,269	06:31:55	07:15:00	15:51:00	01:00:00	7:36:00	1:04:05	31240	33675		51178	55858	55196	227147
31/03/2025	86.00%	59.28%	99.74%	50.85%	35,570	228,910	06:26:08	07:15:00	15:44:00	01:00:00	7:29:00	1:02:52	32306	32907		52332	55967	55321	228833
01/04/2025	77.71%	58.00%	99.65%	44.91%	34,800	241,571	06:56:30	07:15:00	17:11:00	01:00:00	8:56:00	1:59:30	35655	33721		59031	56767	56283	241457
02/04/2025			99.72%			226,705							32693	33691		50899	55645	53777	226705
03/04/2025	91.15%	55.82%	99.75%	50.75%	33,490	227,919	06:48:20	07:15:00	15:43:00	01:00:00	7:28:00	0:39:40	31534	33934		52732	55528	54087	227815
04/04/2025	82.45%	56.96%	99.72%	46.83%	34,175	237,620	06:57:11	07:15:00	16:41:00	01:00:00	8:26:00	1:28:49	35043	33789		56135	56568	55932	237467
05/04/2025	85.04%	55.77%	99.80%	47.34%	33,462	221,488	06:37:09	07:15:00	16:02:00	01:00:00	7:47:00	1:09:51	29901	32183		49621	55628	54026	221359
06/04/2025	93.88%	54.36%	99.80%	50.93%	32,615	228,630	07:00:36	07:15:00	15:43:00	01:00:00	7:28:00	0:27:24	32438	32927		54025	55876	53409	228675
07/04/2025	93.71%	54.84%	99.81%	51.29%	32,901	232,257	07:03:33	07:15:00	15:47:00	01:00:00	7:32:00	0:28:27	35397	33852		54612	56175	52097	232133
08/04/2025	84.94%	58.75%	99.74%	49.77%	35,248	226,545	06:25:38	07:15:00	15:49:00	01:00:00	7:34:00	1:08:22	31498	32877		53198	56162	52657	226392
09/04/2025	87.10%	56.67%	99.76%	49.24%	34,002	229,029	06:44:09	07:15:00	15:59:00	01:00:00	7:44:00	0:59:51	32533	32911		53462	56046	53911	228863
10/04/2025	86.35%	58.92%	99.79%	50.77%	35,352	230,989	06:32:02	07:15:00	15:49:00	01:00:00	7:34:00	1:01:58	33030	33123		53771	56185	54662	230771
11/04/2025	86.87%	59.05%	99.77%	51.18%	35,433	230,342	06:30:03	07:15:00	15:44:00	01:00:00	7:29:00	0:58:57	32376	32792		54100	56247	54708	230223
12/04/2025	87.23%	56.43%	99.71%	49.08%	33,857	228,391	06:44:45	07:15:00	15:59:00	01:00:00	7:44:00	0:59:15	31929	32916		52888	56141	54517	228391
13/04/2025			99.73%			135,675							16958	23615		19721	44767	30614	135675
14/04/2025			99.76%			257,254							33154	32704		64245	63561	63590	257254
15/04/2025			99.64%			224,329							32801	33130		50533	55505	52360	224329
16/04/2025	89.97%	60.65%	99.73%	54.42%	36,390	307,771	08:27:27	07:15:00	17:39:00	01:00:00	9:24:00	0:56:33	48542	42276		82186	61692	72938	307634
17/04/2025	88.27%	55.99%	99.75%	49.30%	33,591	224,855	06:41:38	07:15:00	15:50:00	01:00:00	7:35:00	0:53:22	32395	33178		51507	55362	52298	224740
18/04/2025	86.21%	53.58%	99.73%	46.07%	32,150	228,197	07:05:52	07:15:00	16:29:00	01:00:00	8:14:00	1:08:08	31557	32030		53128	56146	55175	228036
19/04/2025	84.92%	55.98%	99.74%	47.41%	33,587	225,800	06:43:22	07:15:00	16:10:00	01:00:00	7:55:00	1:11:38	30515	31747		53908	55833	53680	225683
20/04/2025	94.23%	52.65%	99.74%	49.48%	31,589	224,735	07:06:52	07:15:00	15:48:00	01:00:00	7:33:00	0:26:08	27234	33332		51180	55644	53171	220561
21/04/2025	89.27%	55.52%	99.83%	49.48%	33,310	219,557	06:35:29	07:15:00	15:38:00	01:00:00	7:23:00	0:47:31	25666	31450		52446	55887	53838	219287
22/04/2025	88.01%	52.65%	99.67%	46.18%	31,589	224,735	07:06:52	07:15:00	16:20:00	01:00:00	8:05:00	0:58:08	25166	33399	2	55021	56102	54942	224632
23/04/2025	83.33%	55.40%	99.69%	46.02%	33,242	219,286	06:35:48	07:15:00	16:10:00	01:00:00	7:55:00	1:19:12	22480	34641	7	52465	55836	54088	219517
24/04/2025	91.33%	51.26%	99.73%	46.69%	30,754	211,126	06:51:54	07:15:00	15:46:00	01:00:00	7:31:00	0:39:06	18043	31569	5	52100	55430	53808	210955
25/04/2025	90.43%	51.80%	99.79%	46.75%	31,082	214,085	06:53:16	07:15:00	15:52:00	01:00:00	7:37:00	0:43:44	17443	32940	7	52913	55987	54728	214018
26/04/2025	85.74%	55.54%	99.74%	47.49%	33,321	214,275	06:25:50	07:15:00	15:45:00	01:00:00	7:30:00	1:04:10	16963	33059	71	53386	55814	54890	214183
27/04/2025	82.72%	52.63%	99.72%	43.41%	31,575	211,554	06:42:00	07:15:00	16:21:00	01:00:00	8:06:00	1:24:00	15521	32810	85	52065	56251	54716	211448
28/04/2025	91.53%	51.98%	99.79%	47.48%	31,188	212,677	06:49:09	07:15:00	15:42:00	01:00:00	7:27:00	0:37:51	14698	33007	125	53742	55753	55152	212477
29/04/2025	88.83%	51.94%	99.74%	46.01%	31,164	210,381	06:45:03	07:15:00	15:51:00	01:00:00	7:36:00	0:50:57	13161	32944	177	52704	56068	55188	210242
30/04/2025	87.91%	52.11%	99.77%	45.71%	31,268	208,450	06:40:00	07:15:00	15:50:00	01:00:00	7:35:00	0:55:00	12420	31914	315	53103	56018	54584	208354
01/05/2025	85.51%	51.70%	99.82%	44.13%	31,021	208,218	06:42:44	07:15:00	16:06:00	01:00:00	7:51:00	1:08:16	12207	33119	431	51672	56049	54646	208124
02/05/2025	85.61%	49.82%	99.73%	42.54%	29,893	207,288	06:56:04	07:15:00	16:21:00	01:00:00	8:06:00	1:09:56	10744	32154	584	52926	56115	54663	207186
03/05/2025	92.85%	49.76%	99.74%	46.09%	29,857	203,304	06:48:33	07:15:00	15:35:00	01:00:00	7:20:00	0:31:27	9877	31850	750	51242	55790	53657	203166
04/05/2025	87.95%	50.23%	99.75%	44.07%	30,138	208,960	06:56:00	07:15:00	16:08:00	01:00:00	7:53:00	0:57:00	9270	32333	913	53798	56549	56029	208892
05/05/2025	89.75%	50.00%	99.68%	44.73%	30,000	205,078	06:50:09	07:15:00	15:52:00	01:00:00	7:37:00	0:46:51	7399	33140	1155	52705	55939	54651	204989
06/05/2025	86.53%	46.72%	99.77%	40.33%	28,033	200,523	07:09:11	07:15:00	16:31:00	01:00:00	8:16:00	1:06:49	4546	31210	1488	51929	56370	54894	200437
07/05/2025	90.09%	45.75%	99.78%	41.12%	27,450	201,541	07:20:32	07:15:00	16:24:00	01:00:00	8:09:00	0:48:28	4129	32320	1891	51807	56153	55182	201482
08/05/2025	88.32%	49.69%	99.87%	43.83%	29,813	200539	06:43:36	07:15:00	15:52:00	01:00:00	7:37:00	0:53:24	2613	33757	2276	51963	55912	53904	200425
09/05/2025	88.71%	47.82%	99.81%	42.34%	28,693	194,729	06:47:12	07:15:00	15:54:00	01:00:00	7:39:00	0:51:48	1077	32094	2769	50743	55996	53413	196092
10/05/2025	83.85%	54.52%	99.85%	45.65%	32,714	186,080	05:41:17	07:15:00	15:02:00	01:00:00	6:47:00	1:05:43	108	31250	3228	44833	55351	51310	186080
11/05/2025			99.85%											32623	4123	51498	56222	53811	198277
12/05/2025	85.63%	54.35%	99.82%	46.45%	32,608	205,219	06:17:37	07:15:00	15:36:00	01:00:00	7:21:00	1:03:23		32685	4895	54779	56118	56742	205219
13/05/2025	65.99%	54.11%	99.70%	35.60%	32,467	206,412	06:21:27	07:15:00	17:53:00	01:00:00	9:38:00	3:16:33		32516	6354	54051	57449	56040	206410
14/05/2025	84.24%	52.79%	99.87%	44.41%	31,674	188,550	05:57:10	07:15:00	15:19:00	01:00:00	7:04:00	1:06:50		30795	7366	45673	54691	50025	188550
15/05/2025	86.89%	55.24%	99.79%	47.90%	33,147	209,294	06:18:51	07:15:00	15:31:00	01:00:00	7:16:00	0:57:09		33068	9142	54036	56145	56903	209294
16/05/2025	87.03%	55.37%	99.84%	48.11%	33,222	207,201	06:14:13	07:15:00	15:25:00	01:00:00	7:10:00	0:55:47		31974	11863	52961	56010	54392	207200
17/05/2025	83.46%	55.70%	99.79%	46.39%	33,419	212,895	06:22:14	07:15:00	15:53:00	01:00:00	7:38:00	1:15:46		32628	14178	53428	56571	56090	212895
18/05/2025	81.11%	58.79%	99.87%	47.62%	35,273	206,932	05:52:00	07:15:00	15:29:00	01:00:00	7:14:00	1:22:00		32965	16415	51659	55700	52156	208895
19/05/2025	82.94%	59.89%	99.79%	49.57%	35,933	213,593	05:56:39	07:15:00	15:25:00	01:00:00	7:10:00	1:13:21		31885	19805	50674	56109	55119	213592
20/05/2025	75.65%	62.89%	99.82%	47.49%	37,734	220,756	05:51:01	07:15:00	15:59:00	01:00:00	7:44:00	1:52:59		33007	22710	55487	56491	57078	224773
21/05/2025	87.60%	57.56%	99.84%	50.34%	34,534	200,680	05:48:40	07:15:00	14:53:00	01:00:00	6:38:00	0:49:20		29348	24388	43628	54212	49104	200680
22/05/2025	84.29%	62.34%	99.84%	52.46%	37,405	228,046	06:05:48	07:15:00	15:29:00	01:00:00	7:14:00	1:08:12		32060	27737	53915	57440	56894	228046
23/05/2025	85.14%	59.81%	99.84%	50.84%	35,887	223,040	06:12:54	07:15:00	15:33:00	01:00:00	7:18:00	1:05:06		32186	29613	51566	55895	53780	223040
24/05/2025	87.71%	56.34%	99.85%	49.34%	33,801	230,758	06:49:37	07:15:00	16:02:00	01:00:00	7:47:00	0:57:23		31770	32305	54263	56325	56095	230758
25/05/2025	90.11%	57.69%	99.84%	51.91%	34,615	221,987	06:24:47	07:15:00	15:22:00	01:00:00	7:07:00	0:42:13		32527	32858	49150	55296	52156	221987
26/05/2025	84.85%	56.92%	99.85%	48.22%	34,149	226,506	06:37:58	07:15:00	16:04:00	01:00:00	7:49:00	1:11:02		30378	35110	50434	55570	55014	226506
27/05/2025	83.27%	58.69%	99.80%	48.77%	35,215	227,731	06:28:01	07:15:00	16:01:00	01:00:00	7:46:00	1:17:59		31601	35601	50462	56337	53730	227731
28/05/2025	80.82%	61.61%	99.79%	49.69%	36,967	237,020	06:24:42	07:15:00	16:11:00	01:00:00	7:56:00	1:31:18		32648	37761	55273	55211	56127	237020
29/05/2025			99.83%											31621	37349	52025	54885	51614	227494
30/05/2025	81.54%	59.62%	99.83%	48.53%	35,771	233,821	06:32:12	07:15:00	16:16:00	01:00:00	8:01:00	1:28:48		30940	39276	51267	56243	56095	233821
31/05/2025	86.47%	59.91%	99.84%	51.73%	35,948	222,776	06:11:50	07:15:00	15:25:00	01:00:00	7:10:00	0:58:10		31032	38187	46154	55098	52305	222776
01/06/2025	90.49%	55.17%	99.84%	49.85%	33,102	249127	07:31:34	07:15:00	16:34:00	01:00:00	8:19:00	0:47:26		36064	40324	58336	56622	57781	249127
02/06/2025	87.07%	58.77%	99.83%	51.08%	35,260	213891	06:03:58	07:15:00	15:13:00	01:00:00	6:58:00	0:54:02		26805	38698	45425	54264	48699	213891
03/06/2025	81.76%	61.18%	99.85%	49.94%	36,707	252583	06:52:52	07:15:00	16:40:00	01:00:00	8:25:00	1:32:08		35891	41232	58547	57191	59722	252583
04/06/2025	83.47%	57.67%	99.81%	48.05%	34,600	217569	06:17:17	07:15:00	15:47:00	01:00:00	7:32:00	1:14:43		27043	40282	45225	54843	50176	217569
05/06/2025	83.55%	61.90%	99.85%	51.64%	37,142	238419	06:25:09	07:15:00	15:56:00	01:00:00	7:41:00	1:15:51		31684	41031	53006	56301	56397	238419
06/06/2025	82.65%	61.55%	99.85%	50.80%	36,932	222824	06:02:00	07:15:00	15:33:00	01:00:00	7:18:00	1:16:00		30156	40512	47252	55118	49786	222824
07/06/2025	83.56%	62.99%	99.86%	52.56%	37,793	230537	06:06:00	07:15:00	15:33:00	01:00:00	7:18:00	1:12:00		31305	40689	51031	54648	52864	230537
08/06/2025	90.09%	56.50%	99.86%	50.83%	33,903	231103	06:49:00	07:15:00	15:49:00	01:00:00	7:34:00	0:45:00		30880	40475	50410	55516	53822	231103
09/06/2025	87.07%	62.50%	99.82%	54.32%	37,499	235619	06:17:00	07:15:00	15:28:00	01:00:00	7:13:00	0:56:00		31133	40834	52285	56007	55360	235619
10/06/2025	85.88%	62.13%	99.84%	53.27%	37,277	230495	06:11:00	07:15:00	15:27:00	01:00:00	7:12:00	1:01:00		31196	40578	50038	55107	53576	230495
11/06/2025	86.97%	62.48%	99.87%	54.27%	37,490	229315	06:07:00	07:15:00	15:17:00	01:00:00	7:02:00	0:55:00		31093	40497	50217	54470	53038	229315
12/06/2025	84.98%	64.31%	99.85%	54.57%	38,589	232819	06:02:00	07:15:00	15:21:00	01:00:00	7:06:00	1:04:00		31172	41104	50948	55364	54231	232819
13/06/2025	83.87%	64.30%	99.88%	53.87%	38,580	234052	06:04:00	07:15:00	15:29:00	01:00:00	7:14:00	1:10:00		30755	41604	52366	55277	54050	234052
14/06/2025	83.93%	62.80%	99.85%	52.63%	37,683	236145	06:16:00	07:15:00	15:43:00	01:00:00	7:28:00	1:12:00		32099	42005	52141	55112	54788	236145
15/06/2025	83.19%	61.39%	99.82%	50.98%	36,837	243123	06:36:00	07:15:00	16:11:00	01:00:00	7:56:00	1:20:00		32456	42652	54647	55896	57472	243123
16/06/2025	74.38%	60.85%	99.82%	45.18%	36,511	217240	05:57:00	07:15:00	16:15:00	01:00:00	8:00:00	2:03:00		28169	41535	46251	52373	48912	217240
17/06/2025	79.05%	64.60%	99.86%	50.99%	38,762	246139	06:21:00	07:15:00	16:17:00	01:00:00	8:02:00	1:41:00		31431	43533	53957	57571	59647	246139
18/06/2025	85.18%	62.10%	99.86%	52.82%	37,258	224789	06:02:00	07:15:00	15:20:00	01:00:00	7:05:00	1:03:00		30281	42022	48631	53956	49899	224789
19/06/2025	79.72%	59.11%	99.81%	47.03%	35,468	234677	06:37:00	07:15:00	16:33:00	01:00:00	8:18:00	1:41:00		30320	43657	50729	55531	54440	234677
20/06/2025	82.55%	67.01%	99.80%	55.21%	40,207	234538	05:50:00	07:15:00	15:19:00	01:00:00	7:04:00	1:14:00		31270	42190	52219	54555	54304	234538
21/06/2025	83.69%	65.56%	99.81%	54.77%	39,337	228811	05:49:00	07:15:00	15:12:00	01:00:00	6:57:00	1:08:00		29322	43034	48671	54479	53305	228811
22/06/2025	82.94%	66.03%	99.83%	54.68%	39,619	234415	05:55:00	07:15:00	15:23:00	01:00:00	7:08:00	1:13:00		30636	43438	51535	54829	53977	234415
23/06/2025	87.09%	66.87%	99.83%	58.13%	40,120	230019	05:44:00	07:15:00	14:50:00	01:00:00	6:35:00	0:51:00		29999	43113	49981	54209	52717	230019
24/06/2025	86.06%	65.80%	99.86%	56.55%	39,479	235561	05:58:00	07:15:00	15:11:00	01:00:00	6:56:00	0:58:00		30372	43650	51307	55674	54558	235561
25/06/2025	81.50%	68.20%	99.78%	55.46%	40,920	237338	05:48:00	07:15:00	15:22:00	01:00:00	7:07:00	1:19:00		30741	43629	52397	55732	54839	237338
26/06/2025	87.23%	53.61%	99.82%	46.68%	32,166	234275	07:17:00	07:15:00	16:36:00	01:00:00	8:21:00	1:04:00		29947	42952	50785	56406	54185	234275
27/06/2025	79.77%	66.10%	99.77%	52.60%	39,658	231997	05:51:00	07:15:00	15:35:00	01:00:00	7:20:00	1:29:00		29879	44252	49928	53437	54501	231997
28/06/2025	82.68%	64.73%	99.83%	53.43%	38,841	231750	05:58:00	07:15:00	15:28:00	01:00:00	7:13:00	1:15:00		30261	43596	50051	54593	53249	231750
29/06/2025	83.80%	65.44%	99.84%	54.75%	39,263	233,612	05:57:00	07:15:00	15:21:00	01:00:00	7:06:00	1:09:00		29785	43348	51709	54496	54274	233612
30/06/2025	85.27%	61.70%	99.84%	52.53%	37,022	221,512	05:59:00	07:15:00	15:16:00	01:00:00	7:01:00	1:02:00		26864	43394	46839	53819	50596	221512
01/07/2025	84.14%	66.43%	99.77%	55.77%	39,861	241,491	06:03:30	07:15:00	15:27:00	01:00:00	7:12:00	1:08:30		30738	43622	55681	55388	56062	241491
02/07/2025	82.79%	65.02%	99.83%	53.74%	39,011	231,465	05:56:00	07:15:00	15:25:00	01:00:00	7:10:00	1:14:00		29661	43418	49651	54805	53930	231465
03/07/2025	82.48%	65.94%	99.77%	54.26%	39,564	232,769	05:53:00	07:15:00	15:23:00	01:00:00	7:08:00	1:15:00		30457	43539	50287	54786	53700	232769
04/07/2025	83.98%	61.39%	99.79%	51.45%	36,831	225,284	06:07:00	07:15:00	15:32:00	01:00:00	7:17:00	1:10:00		28258	43759	46241	54646	52380	225284
05/07/2025	83.41%	64.90%	99.84%	54.04%	38,938	238,173	06:07:00	07:15:00	15:35:00	01:00:00	7:20:00	1:13:00		31502	43603	53432	54792	54844	238173
06/07/2025	81.67%	66.06%	99.76%	53.82%	39,634	232,519	05:52:00	07:15:00	15:26:00	01:00:00	7:11:00	1:19:00		30052	43532	51088	54608	53239	232519
07/07/2025	76.81%	63.25%	99.75%	48.46%	37,949	240,979	06:21:00	07:15:00	16:31:00	01:00:00	8:16:00	1:55:00		31445	44036	53079	55666	56753	240979
08/07/2025			99.78%			232,104								30826	43326	51414	54308	52230	232104
09/07/2025	75.65%	65.00%	99.81%	49.08%	38,999	228,146	05:51:00	07:15:00	15:59:00	01:00:00	7:44:00	1:53:00		29251	43310	48806	54429	52350	228146
10/07/2025	86.96%	62.49%	99.85%	54.25%	37,491	224,946	06:00:00	07:15:00	15:09:00	01:00:00	6:54:00	0:54:00		28874	43132	48916	53110	50914	224946
11/07/2025	72.31%	64.90%	99.73%	46.80%	38,940	244,025	06:16:00	07:15:00	16:55:00	01:00:00	8:40:00	2:24:00		31013	44355	54383	56109	58165	244025
12/07/2025	75.48%	63.08%	99.79%	47.51%	37,847	223,299	05:54:00	07:15:00	16:04:00	01:00:00	7:49:00	1:55:00		28427	43122	46930	53817	51003	223299
13/07/2025	86.62%	63.38%	99.79%	54.78%	38,028	225,632	05:56:00	07:30:00	15:21:00	01:00:00	6:51:00	0:55:00		29252	43298	48628	53929	50525	225632
14/07/2025	82.71%	66.57%	99.77%	54.93%	39,941	235,650	05:54:00	07:15:00	15:23:00	01:00:00	7:08:00	1:14:00		29751	43690	52697	54383	55129	235650
15/07/2025	79.17%	67.17%	99.71%	53.02%	40,300	229,709	05:42:00	07:15:00	15:27:00	01:00:00	7:12:00	1:30:00		30567	43437	49989	54117	51599	229709
16/07/2025	83.63%	60.63%	99.76%	50.59%	36,378	226,149	06:13:00	07:30:00	15:56:00	01:00:00	7:26:00	1:13:00		29561	43606	48377	54777	49828	226149
17/07/2025	80.97%	60.86%	99.81%	49.19%	36,518	243,455	06:40:00	07:15:00	16:29:00	01:00:00	8:14:00	1:34:00		32053	43832	54996	55189	57385	243455
18/07/2025	79.42%	63.71%	99.82%	50.51%	38,229	226,188	05:55:00	07:15:00	15:42:00	01:00:00	7:27:00	1:32:00		28716	43267	48918	54088	51199	226188
19/07/2025	81.40%	65.55%	99.84%	53.27%	39,330	229,425	05:50:00	07:15:00	15:25:00	01:00:00	7:10:00	1:20:00		30013	43343	49525	53826	52718	229425
20/07/2025	82.27%	62.78%	99.83%	51.56%	37,667	227,258	06:02:00	07:15:00	15:35:00	01:00:00	7:20:00	1:18:00		28914	43651	47560	54457	52676	227258
21/07/2025	87.10%	65.54%	99.81%	56.98%	39,326	234,647	05:58:00	07:30:00	15:21:00	01:00:00	6:51:00	0:53:00		28984	43315	53701	54208	54439	234647
22/07/2025	84.95%	62.68%	99.80%	53.14%	37,608	230,037	06:07:00	07:15:00	15:27:00	01:00:00	7:12:00	1:05:00		29234	43526	49651	54704	52922	230037
23/07/2025	83.10%	64.02%	99.85%	53.12%	38,411	226,622	05:54:00	07:15:00	15:21:00	01:00:00	7:06:00	1:12:00		28543	43439	48474	54206	51960	226622
24/07/2025	84.34%	64.83%	99.83%	54.58%	38,895	226,890	05:50:00	07:15:00	15:10:00	01:00:00	6:55:00	1:05:00		28682	43286	49289	53711	51922	226890
25/07/2025	87.12%	62.89%	99.85%	54.71%	37,735	233,956	06:12:00	07:15:00	15:22:00	01:00:00	7:07:00	0:55:00		28934	43426	52251	55074	54271	233956
26/07/2025	80.93%	66.12%	99.84%	53.42%	39,673	230,101	05:48:00	07:15:00	15:25:00	01:00:00	7:10:00	1:22:00		28895	43404	49759	54510	53533	230101
27/07/2025	86.47%	65.15%	99.85%	56.25%	39,087	224,752	05:45:00	07:15:00	14:54:00	01:00:00	6:39:00	0:54:00		28447	43105	49317	52986	50897	224752
28/07/2025	86.26%	62.66%	99.86%	53.97%	37,597	228,087	06:04:00	07:15:00	15:17:00	01:00:00	7:02:00	0:58:00		28158	43311	48873	54408	53337	228087
29/07/2025	84.35%	57.59%	99.81%	48.48%	34,552	238,988	06:55:00	07:15:00	16:27:00	01:00:00	8:12:00	1:17:00		29144	43647	53485	56470	56242	238988
30/07/2025	84.69%	64.43%	99.83%	54.48%	38,661	221,012	05:43:00	07:15:00	15:00:00	01:00:00	6:45:00	1:02:00		28111	42482	46937	53135	50347	221012
31/07/2025	83.78%	66.01%	99.79%	55.18%	39,604	232,805	05:52:42	07:15:00	15:16:00	01:00:00	7:01:00	1:08:18		28376	43259	51822	54872	54476	232805
`;

    // --- Data Section ---
    const monthlyData = {
        labels: ['ก.พ.', 'มี.ค.', 'เม.ย.', 'พ.ค.', 'มิ.ย.', 'ก.ค.'],
        performance: [56.84, 58.49, 54.51, 55.89, 62.48, 63.54]
    };

    const distributionDataPoints = [
        {x: 28000, y: 6}, {x: 30000, y: 4}, {x: 32000, y: 29},
        {x: 34000, y: 35}, {x: 36000, y: 41}, {x: 38000, y: 31}, {x: 40000, y: 8}
    ];
    
    const stats = {
        min: 27450,
        q1: 33378,
        median: 35582,
        mean: 35364,
        q3: 37278,
        max: 40920
    };

    const lossTimeData = {
        labels: ['< 30 นาที', '30-60 นาที', '60-90 นาที', '> 90 นาที'],
        production: [37500, 36200, 34800, 32100]
    };

    const operationTimeData = {
        labels: ['< 7 ชม.', '7-7.5 ชม.', '7.5-8 ชม.', '> 8 ชม.'],
        performance: [61.2, 59.8, 57.3, 55.1]
    };
    
    const baseCases = {
        conservative: {
            title: 'Conservative (ระมัดระวัง)',
            value: '35,600 ฟอง/ชม.',
            performance: '59.3% Perf.',
            reason: 'ใช้ค่า Median, มีโอกาสสำเร็จ 50% เหมาะกับการเริ่มต้น',
            colorClass: 'bg-sky-50 border-sky-200'
        },
        moderate: {
            title: 'Moderate (ปานกลาง)',
            value: '36,400 ฟอง/ชม.',
            performance: '60.7% Perf.',
            reason: 'สูงกว่าค่าเฉลี่ยเล็กน้อย ท้าทายกำลังดี',
            colorClass: 'bg-indigo-50 border-indigo-200'
        },
        stretch: {
            title: 'Stretch (ท้าทาย)',
            value: '37,300 ฟอง/ชม.',
            performance: '62.2% Perf.',
            reason: 'ใช้ค่า Q3, มีโอกาสสำเร็จ 25% เหมาะกับทีมที่พร้อม',
            colorClass: 'bg-amber-50 border-amber-200'
        }
    };

    // --- Data Parsing Functions ---
    function parseData(rawData) {
        const scatterPoints = [];
        const jitterPoints = [];
        const lines = rawData.trim().split('\n').slice(1);
        lines.forEach(line => {
            const columns = line.split('\t');
            if (columns.length < 13) return;

            const productHStr = columns[5];
            const lossTimeStr = columns[12];

            if (!productHStr || !lossTimeStr || !lossTimeStr.includes(':')) return;

            try {
                const productH = parseInt(productHStr.replace(/,/g, ''), 10);
                
                const timeParts = lossTimeStr.split(':');
                const hours = parseInt(timeParts[0], 10);
                const minutes = parseInt(timeParts[1], 10);
                const seconds = parseInt(timeParts[2], 10);
                const totalMinutes = hours * 60 + minutes + seconds / 60;

                if (!isNaN(productH) && !isNaN(totalMinutes)) {
                    // Data for Loss Time vs Production scatter
                    scatterPoints.push({ x: totalMinutes, y: productH });
                    // Data for Jitter plot (Production distribution)
                    jitterPoints.push({ x: productH, y: Math.random() * 2 - 1 }); // y is random for spread
                }
            } catch (e) {
                // console.error("Could not parse line:", line, e);
            }
        });
        return { scatterPoints, jitterPoints };
    }
    const { scatterPoints, jitterPoints } = parseData(rawData);


    // --- Chart Rendering ---
    document.addEventListener('DOMContentLoaded', () => {
        // 1. Monthly Performance Chart
        const ctxMonthly = document.getElementById('monthlyPerformanceChart').getContext('2d');
        new Chart(ctxMonthly, {
            type: 'line',
            data: { labels: monthlyData.labels, datasets: [{ label: 'Performance เฉลี่ย (%)', data: monthlyData.performance, borderColor: 'rgb(59, 130, 246)', backgroundColor: 'rgba(59, 130, 246, 0.1)', fill: true, tension: 0.3, pointRadius: 5, pointBackgroundColor: 'rgb(59, 130, 246)' }] },
            options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: false, title: { display: true, text: 'Performance (%)' } } }, plugins: { legend: { display: false }, tooltip: { callbacks: { label: (c) => `Performance: ${c.parsed.y.toFixed(2)}%` } } } }
        });

        // 2. Distribution Chart (Histogram)
        const ctxDist = document.getElementById('distributionChart').getContext('2d');
        new Chart(ctxDist, {
            type: 'bar',
            data: { datasets: [{ label: 'จำนวนวัน', data: distributionDataPoints, backgroundColor: 'rgba(107, 114, 128, 0.6)', borderColor: 'rgb(107, 114, 128)', borderWidth: 1, barPercentage: 1.0, categoryPercentage: 1.0 }] },
            options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, title: { display: true, text: 'จำนวนวัน' } }, x: { type: 'linear', min: 26000, max: 42000, title: { display: true, text: 'ฟอง/ชั่วโมง' }, ticks: { stepSize: 4000 } } }, plugins: { legend: { display: false }, tooltip: { callbacks: { title: (c) => `ผลผลิต: ${(c[0].parsed.x - 1000).toLocaleString()} - ${(c[0].parsed.x + 1000).toLocaleString()} ฟอง/ชม.`, label: (c) => `จำนวน: ${c.parsed.y} วัน` } }, annotation: { annotations: { meanLine: { type: 'line', xValue: stats.mean, borderColor: 'rgb(239, 68, 68)', borderWidth: 2, label: { content: `เฉลี่ย: ${stats.mean.toLocaleString()}`, enabled: true, position: 'start', backgroundColor: 'rgb(239, 68, 68)', font: { size: 10, weight: 'bold' }, yAdjust: -10 } }, medianLine: { type: 'line', xValue: stats.median, borderColor: 'rgb(16, 185, 129)', borderWidth: 1.5, borderDash: [6, 6], label: { content: `ค่ากลาง: ${stats.median.toLocaleString()}`, enabled: true, position: 'start', backgroundColor: 'rgb(16, 185, 129)', font: { size: 10 }, yAdjust: 10 } }, q1Line: { type: 'line', xValue: stats.q1, borderColor: 'rgb(59, 130, 246)', borderWidth: 1.5, borderDash: [6, 6], label: { content: `Q1: ${stats.q1.toLocaleString()}`, enabled: true, position: 'start', backgroundColor: 'rgb(59, 130, 246)', font: { size: 10 }, yAdjust: 30 } }, q3Line: { type: 'line', xValue: stats.q3, borderColor: 'rgb(249, 115, 22)', borderWidth: 1.5, borderDash: [6, 6], label: { content: `Q3: ${stats.q3.toLocaleString()}`, enabled: true, position: 'start', backgroundColor: 'rgb(249, 115, 22)', font: { size: 10 }, yAdjust: 50 } } } } } }
        });

        // 3. Loss Time Chart
        const ctxLoss = document.getElementById('lossTimeChart').getContext('2d');
        new Chart(ctxLoss, {
            type: 'bar',
            data: { labels: lossTimeData.labels, datasets: [{ label: 'ผลผลิตเฉลี่ย (ฟอง/ชม.)', data: lossTimeData.production, backgroundColor: ['rgba(34, 197, 94, 0.6)', 'rgba(251, 191, 36, 0.6)', 'rgba(249, 115, 22, 0.6)', 'rgba(239, 68, 68, 0.6)'] }] },
            options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { title: { display: true, text: 'ผลผลิตเฉลี่ย (ฟอง/ชม.)' } } } }
        });

        // 4. Operation Time Chart
        const ctxOp = document.getElementById('operationTimeChart').getContext('2d');
        new Chart(ctxOp, {
            type: 'bar',
            data: { labels: operationTimeData.labels, datasets: [{ label: 'Performance เฉลี่ย (%)', data: operationTimeData.performance, backgroundColor: ['rgba(34, 197, 94, 0.6)', 'rgba(163, 230, 53, 0.6)', 'rgba(251, 191, 36, 0.6)', 'rgba(249, 115, 22, 0.6)'] }] },
            options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { title: { display: true, text: 'Performance เฉลี่ย (%)' } } } }
        });

        // 5. Jitter Plot
        const ctxJitter = document.getElementById('jitterPlotChart').getContext('2d');
        new Chart(ctxJitter, {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'ผลผลิตรายวัน',
                    data: jitterPoints,
                    backgroundColor: 'rgba(16, 185, 129, 0.5)', // emerald-500
                    pointRadius: 4,
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                scales: {
                    x: { type: 'linear', position: 'bottom', title: { display: true, text: 'ผลผลิตต่อชั่วโมง (ฟอง/ชม.)' } },
                    y: { display: false, min: -2, max: 2 }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: { callbacks: { label: (c) => `ผลผลิต: ${c.parsed.x.toLocaleString()} ฟอง/ชม.` } },
                    annotation: {
                        annotations: {
                            meanLine: { type: 'line', xMin: stats.mean, xMax: stats.mean, borderColor: 'rgb(239, 68, 68)', borderWidth: 2, label: { content: `เฉลี่ย`, enabled: true, position: 'start', font: {size: 10} } },
                            medianLine: { type: 'line', xMin: stats.median, xMax: stats.median, borderColor: 'rgb(249, 115, 22)', borderWidth: 2, borderDash: [6, 6], label: { content: `ค่ากลาง`, enabled: true, position: 'end', font: {size: 10} } }
                        }
                    }
                }
            }
        });

        // 6. Scatter Plot
        const ctxScatter = document.getElementById('scatterPlotChart').getContext('2d');
        new Chart(ctxScatter, {
            type: 'scatter',
            data: { datasets: [{ label: 'ข้อมูลรายวัน', data: scatterPoints, backgroundColor: 'rgba(59, 130, 246, 0.6)' }] },
            options: {
                responsive: true, maintainAspectRatio: false,
                scales: {
                    x: { type: 'linear', position: 'bottom', title: { display: true, text: 'Loss Time (นาที)' } },
                    y: { title: { display: true, text: 'ผลผลิตต่อชั่วโมง (ฟอง/ชม.)' } }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const label = ` Loss Time: ${context.parsed.x.toFixed(2)} นาที`;
                                const label2 = `ผลผลิต: ${context.parsed.y.toLocaleString()} ฟอง/ชม.`;
                                return [label, label2];
                            }
                        }
                    }
                }
            }
        });
        
        // Initial Base Case Display
        updateBaseCase('conservative');
    });

    // --- Interactivity ---
    function updateBaseCase(type) {
        const data = baseCases[type];
        const displayDiv = document.getElementById('baseCaseDisplay');
        displayDiv.innerHTML = `
            <div class="p-4 rounded-lg border ${data.colorClass}">
                <h4 class="font-bold text-lg text-slate-800">${data.title}</h4>
                <p class="text-2xl font-bold text-slate-900">${data.value} <span class="text-base font-normal text-slate-600">(${data.performance})</span></p>
                <p class="text-sm text-slate-600 mt-1">${data.reason}</p>
            </div>
        `;
    }
</script>

</body>
</html>
